Download Link: https://assignmentchef.com/product/solved-cosc328-lab7-icmp-protocol
<br>
In this lab, we’ll explore several aspects of the ICMP protocol:

<ul>

 <li>ICMP messages generating by the Ping program; ICMP messages generated by the Traceroute program;</li>

 <li>the format and contents of an ICMP message.</li>

</ul>

Before attacking this lab, you’re encouraged to review the ICMP material in section 5.6 of the text<a href="#_ftn1" name="_ftnref1"><sup>[1]</sup></a>. We present this lab in the context of the Microsoft Windows operating system. However, it is straightforward to translate the lab to a Unix or Linux environment.

<h1>1.  ICMP and Ping</h1>

Let’s begin our ICMP adventure by capturing the packets generated by the Ping program. You may recall that the Ping program is simple tool that allows anyone (for example, a network administrator) to verify if a host is live or not. The Ping program in the source host sends a packet to the target IP address; if the target is live, the Ping program in the target host responds by sending a packet back to the source host. As you might have guessed (given that this lab is about ICMP), both of these Ping packets are ICMP packets.

Do the following<a href="#_ftn2" name="_ftnref2"><sup>[2]</sup></a>:

<ul>

 <li>Let’s begin this adventure by opening the Windows Command Prompt application (which can be found in your Accessories folder).</li>

 <li>Start up the Wireshark packet sniffer, and begin Wireshark packet capture.</li>

 <li>The <em>ping</em> command is in c:windowssystem32, so type either “<em>ping –n 10 hostname</em>” or “<em>c:windowssystem32ping –n 10 hostname</em>” in the MS-DOS command line (without quotation marks), where hostname is a host on another continent. If you’re outside of Asia, you may want to enter www.ust.hk for the Web server at Hong Kong University of Science and Technology. The argument <em>“-n 10</em>” indicates that 10 ping messages should be sent. Then run the Ping program by typing return.</li>

 <li>When the Ping program terminates, stop the packet capture in Wireshark.</li>

</ul>

At the end of the experiment, your Command Prompt Window should look something like Figure 1. In this example, the source ping program is in Massachusetts and the destination Ping program is in Hong Kong. From this window we see that the source ping program sent 10 query packets and received 10 responses. Note also that for each response, the source calculates the round-trip time (RTT), which for the 10 packets is on average 375 msec.

<strong>Figure 1</strong> Command Prompt window after entering Ping command.

Figure 2 provides a screenshot of the Wireshark output, after “icmp” has been entered into the filter display window.  Note that the packet listing shows 20 packets: the 10 Ping queries sent by the source and the 10 Ping responses received by the source. Also note that the source’s IP address is a private address (behind a NAT) of the form 192.168/12; the destination’s IP address is that of the Web server at HKUST. Now let’s zoom in on the first packet (sent by the client); in the figure below, the packet contents area provides information about this packet. We see that the IP datagram within this packet has protocol number 01, which is the protocol number for ICMP. This means that the payload of the IP datagram is an ICMP packet.

<strong>Figure 2</strong> Wireshark output for Ping program with Internet Protocol expanded.

Figure 3 focuses on the same ICMP but has expanded the ICMP protocol information in the packet contents window. Observe that this ICMP packet is of Type 8 and Code 0 – a so-called ICMP “echo request” packet. (See Figure 5.19 of text.) Also note that this ICMP packet contains a checksum, an identifier, and a sequence number.

<strong>Figure 3</strong> Wireshark capture of ping packet with ICMP packet expanded.

<strong>What to Hand In: </strong>

You should hand in a screen shot of the Command Prompt window similar to Figure 1 above. Whenever possible, when answering a question below, you should hand in a printout of the packet(s) within the trace that you used to answer the question asked.  Annotate the printout<a href="#_ftn3" name="_ftnref3"><sup>[3]</sup></a> to explain your answer. To print a packet, use <em>File-&gt;Print</em>, choose <em>Selected packet only</em>, choose <em>Packet summary line,</em> and select the minimum amount of packet detail that you need to answer the question.

You should answer the following questions:

<ol>

 <li>What is the IP address of your host? What is the IP address of the destination host?</li>

 <li>Why is it that an ICMP packet does not have source and destination port numbers?</li>

 <li>Examine one of the ping request packets sent by your host. What are the ICMP type and code numbers? What other fields does this ICMP packet have? How many bytes are the checksum, sequence number and identifier fields?</li>

 <li>Examine the corresponding ping reply packet. What are the ICMP type and code numbers? What other fields does this ICMP packet have? How many bytes are the checksum, sequence number and identifier fields?</li>

</ol>

<h1>2.  ICMP and Traceroute</h1>

Let’s now continue our ICMP adventure by capturing the packets generated by the Traceroute program. You may recall that the Traceroute program can be used to figure out the path a packet takes from source to destination. Traceroute is discussed in Section 1.4 and in Section 5.6 of the text.

Traceroute is implemented in different ways in Unix/Linux/MacOS and in Windows. In Unix/Linux, the source sends a series of UDP packets to the target destination using an unlikely destination port number; in Windows, the source sends a series of ICMP packets to the target destination. For both operating systems, the program sends the first packet with TTL=1, the second packet with TTL=2, and so on. Recall that a router will decrement a packet’s TTL value as the packet passes through the router. When a packet arrives at a router with TTL=1, the router sends an ICMP error packet back to the source. In the following, we’ll use the native Windows <em>tracert</em> program. A shareware version of a much nice Windows Traceroute program is <em>pingplotter</em> (<u>www.pingplotter.com</u>).  We’ll use <em>pingplotter</em> in our Wireshark IP lab since it provides additional functionality that we’ll need there.

Do the following<a href="#_ftn4" name="_ftnref4"><sup>[4]</sup></a>:

<ul>

 <li>Let’s begin by opening the Windows Command Prompt application (which can be found in your Accessories folder).</li>

 <li>Start up the Wireshark packet sniffer, and begin Wireshark packet capture.</li>

 <li>The <em>tracert</em> command is in c:windowssystem32, so type either “<em>tracert hostname</em>” or “<em>c:windowssystem32tracert hostname</em>” in the MS-DOS command line (without quotation marks), where hostname is a host on another continent.</li>

</ul>

(Note that on a Windows machine, the command is “<em>tracert</em>” and not “<em>traceroute</em>”.) If you’re outside of Europe, you may want to enter www.inria.fr for the Web server at INRIA, a computer science research institute in France. Then run the Traceroute program by typing return.

<ul>

 <li>When the Traceroute program terminates, stop packet capture in Wireshark.</li>

</ul>

At the end of the experiment, your Command Prompt Window should look something like Figure 4. In this figure, the client Traceroute program is in Massachusetts and the target destination is in France. From this figure we see that for each TTL value, the source program sends three probe packets. Traceroute displays the RTTs for each of the probe packets, as well as the IP address (and possibly the name) of the router that returned the ICMP TTL-exceeded message.

<strong>Figure 4</strong> Command Prompt window displays the results of the Traceroute program.

Figure 5 displays the Wireshark window for an ICMP packet returned by a router. Note that this ICMP error packet contains many more fields than the Ping ICMP messages.

<strong>Figure 5</strong> Wireshark window of ICMP fields expanded for one ICMP error packet.

<strong>What to Hand In: </strong>

For this part of the lab, you should hand in a screen shot of the Command Prompt window. Whenever possible, when answering a question below, you should hand in a printout of the packet(s) within the trace that you used to answer the question asked.  Annotate the printout to explain your answer. To print a packet, use <em>File-&gt;Print</em>, choose <em>Selected packet only</em>, choose <em>Packet summary line,</em> and select the minimum amount of packet detail that you need to answer the question.

Answer the following questions:

<ol start="5">

 <li>What is the IP address of your host? What is the IP address of the target destination host?</li>

 <li>If ICMP sent UDP packets instead (as in Unix/Linux), would the IP protocol number still be 01 for the probe packets? If not, what would it be?</li>

 <li>Examine the ICMP echo packet in your screenshot. Is this different from the ICMP ping query packets in the first half of this lab? If yes, how so?</li>

 <li>Examine the ICMP error packet in your screenshot. It has more fields than the ICMP echo packet. What is included in those fields?</li>

 <li>Examine the last three ICMP packets received by the source host. How are these packets different from the ICMP error packets? Why are they different?</li>

 <li>Within the tracert measurements, is there a link whose delay is significantly longer than others? Refer to the screenshot in Figure 4, is there a link whose delay is significantly longer than others?  On the basis of the router names, can you guess the location of the two routers on the end of this link?</li>

</ol>

<h1>3.  Extra Credit</h1>

For one of the programming assignments you created a UDP client ping program. This ping program, unlike the standard ping program, sends UDP probe packets rather than ICMP probe packets. Use the client program to send a UDP packet with an unusual destination port number to some live host. At the same time, use Wireshark to capture any response from the target host. Provide a Wireshark screenshot for the response as well as an analysis of the response.

<a href="#_ftnref1" name="_ftn1">[1]</a> References to figures and sections are for the 7<sup>th</sup> edition of our text, <em>Computer Networks, A Top-down Approach, 7<sup>th</sup> ed., </em>J.F. Kurose and K.W. Ross, Addison-Wesley/Pearson, 2016.

<a href="#_ftnref2" name="_ftn2">[2]</a> If you are unable to run Wireshark live on a computer, you can download the zip file <u>http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces.zip</u> and extract the file <em>ICMP-ethereal-trace-1</em>. The traces in this zip file were collected by Wireshark running on one of the author’s computers, while performing the steps indicated in the Wireshark lab. Once you have downloaded the trace, you can load it into Wireshark and view the trace using the <em>File</em> pull down menu, choosing <em>Open</em>, and then selecting the <em>ICMP-ethereal-trace-1 </em>trace file.  You can then use this trace file to answer the questions below.

<a href="#_ftnref3" name="_ftn3">[3]</a> What do we mean by “annotate”?  If you hand in a paper copy, please highlight where in the printout you’ve found the answer and add some text (preferably with a colored pen) noting what you found in what you ‘ve highlight.  If you hand in an electronic copy, it would be great if you could also highlight and annotate.

<a href="#_ftnref4" name="_ftn4">[4]</a> If you are unable to run Wireshark live on a computer, you can download the zip file <u>http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces.zip</u> and extract the file <em>ICMP-ethereal-trace-2</em>. The traces in this zip file were collected by Wireshark running on one of the author’s computers, while performing the steps indicated in the Wireshark lab. Once you have downloaded the trace, you can load it into Wireshark and view the trace using the <em>File</em> pull down menu, choosing <em>Open</em>, and then selecting the <em>ICMP-ethereal-trace-2 </em>trace file.  You can then use this trace file to answer the questions below.